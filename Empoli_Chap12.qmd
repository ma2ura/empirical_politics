# 回帰分析の前提と妥当性の診断

```{r}
#| echo: FALSE
library(tidyverse)
library(ggthemes)
mystyle <- list (#  ggplotのテーマ
  theme_few(), # ggthemesパッケージ
  theme(
    text = element_text(
      size=10,  #  フォントサイズ
      family = "HiraKakuProN-W3" # ヒラギノフォント
    )
  )
)
set.seed(123)
```

回帰分析は非常に有用な分析手法ですが、いつでも利用できるわけではなく、分析結果が意味をもつためには、いくつか前提条件が満たされている必要があります。この章では、その前提条件が満たされているかどうか、つまり回帰モデルによる統計的推定が妥当かどうかを診断する手法を学習します。

## 回帰分析の前提

1. @sec-01 モデルが妥当
2. @sec-02 加法制と線形性
3. @sec-03 誤差の独立性
4. @sec-04 誤差が欽一分散
5. @sec-05 誤差が正規分布

### 回帰モデルの妥当性 {#sec-01}

回帰モデルが妥当であるためには、独立変数から応答変数への因果関係をみるのに有用な推定を行えているのかどうか、ということが重要となります。
この妥当性には、

- 内的妥当性 (internal validity)
- 外的妥当性 (external validity)

の2つがあります。
ここでは、**内的妥当性**について考えます。
回帰分析が内的妥当性を持つためには、回帰バンズ寝期の

### 加法性と線形性 {#sec-02}

線形回帰モデルは、核説明変数の線形関数で表される。

$$
y = \beta _1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k
$$

加法性が満たされないモデルには、

$$
y = x_1 \times x_2 \times  x_3
$$

のようなモデルがあり、線形関数ではなくなっています。
しかし両辺の対数をとると、

$$
\log y = \log x_1 + \log x_2 + \log x_3
$$



### 誤差の独立性  {#sec-03}

### 誤差の分散均一性  {#sec-04}

### 誤差の正規性  {#sec-05}

## Rによる回帰診断

### 残差プロットによる診断

### 正規QQプロットによる診断

## まとめ
